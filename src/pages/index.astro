---
import Main from "../layouts/Main.astro";
import { getCollection } from "astro:content";
import { collections } from "../content/config";

const map = new Map<string, { href: string; title: string }[]>(
    await Promise.all(
        Object.keys(collections).map(async (content) => [
            content,
            (
                await getCollection(content)
            ).map(({ slug, data: { title } }) => ({
                href: slug + "/",
                title,
            })),
        ])
    )
);

const content = { title: "note" };
---

<Main {content}>
    <ul>
        {
			Array.from(map.entries()).map(([name, content]) => (
				<li>
					<a href={`./${name}/`}>{name}</a>
					<ul>
						{
							content.map(({ href, title }) => (
								<li>
									<a {href}>{title ?? href}</a>
								</li>
							))
						}
					</ul>
				</li>
			))
		}
    </ul>
</Main>
